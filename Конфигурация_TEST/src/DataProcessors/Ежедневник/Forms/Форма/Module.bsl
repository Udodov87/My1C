
&НаКлиенте
Процедура Команда3(Команда)
	//TODO: Вставить содержимое обработчика
		Для Сч = 1 По 10 Цикл
		СлучайныйГлагол = ПолучитьСлучайныйГлагол();
		Сообщить(СлучайныйГлагол);
	КонецЦикла;
	
	
КонецПроцедуры



&НаСервереБезКонтекста
Функция ПолучитьСлучайныйГлагол()
	
	СписокГлаголов = Новый Массив;
	СписокГлаголов.Добавить("бегать");
	СписокГлаголов.Добавить("прыгать");
	СписокГлаголов.Добавить("сидеть");
	СписокГлаголов.Добавить("работать");
	СписокГлаголов.Добавить("писать");
	СписокГлаголов.Добавить("читать");
	СписокГлаголов.Добавить("думать");
	СписокГлаголов.Добавить("смотреть");
	СписокГлаголов.Добавить("слушать");
	СписокГлаголов.Добавить("говорить");
	СписокГлаголов.Добавить("петь");
	СписокГлаголов.Добавить("спать");
	СписокГлаголов.Добавить("есть");
	СписокГлаголов.Добавить("пить");
	СписокГлаголов.Добавить("ездить");
	СписокГлаголов.Добавить("летать");
	СписокГлаголов.Добавить("плыть");
	СписокГлаголов.Добавить("строить");
	СписокГлаголов.Добавить("рисовать");
	СписокГлаголов.Добавить("танцевать");
	

	СлучайныйИндекс=ПолучитьСлучайноеЧисло(0,19);

Возврат СписокГлаголов[СлучайныйИндекс];

КонецФункции

&наСервереБезКонтекста
Функция ПолучитьСлучайноеЧисло(МинимальноеЗначение, МаксимальноеЗначение) Экспорт
	
	// Создаем новый экземпляр генератора случайных чисел
	Генератор = Новый ГенераторСлучайныхЧисел;
	
	// Возвращаем сгенерированное число в заданном диапазоне
	Возврат Генератор.СлучайноеЧисло(МинимальноеЗначение, МаксимальноеЗначение);
	
КонецФункции



&НаКлиенте
Процедура Команда2(Команда)
	//TODO: Вставить содержимое обработчика

КонецПроцедуры



// Файл: Конфигурация_TEST/src/DataProcessors/Ежедневник/Forms/Форма/Module.bsl
&НаКлиенте
Процедура Команда1(Команда)
	СформироватьЕженедельникНаСервере();
	Элементы.Данные.Редактирование=истина;
КонецПроцедуры



&НаСервере
Процедура СформироватьЕженедельникНаСервере()
	
	// Очищаем табличный документ перед заполнением
	Объект.Данные.Очистить();
	объект.Данные.Защита=ложь;
	
	
	// Инициализируем переменные
	КоличествоДней = 8; // Понедельник-Воскресенье
	НачальныйЧас = 9;
	КонечныйЧас = 18;
	
	// Массив с названиями дней недели
	МассивДнейНедели = Новый Массив;
	МассивДнейНедели.Добавить("Время");
	МассивДнейНедели.Добавить("Понедельник");
	МассивДнейНедели.Добавить("Вторник");
	МассивДнейНедели.Добавить("Среда");
	МассивДнейНедели.Добавить("Четверг");
	МассивДнейНедели.Добавить("Пятница");
	МассивДнейНедели.Добавить("Суббота");
	МассивДнейНедели.Добавить("Воскресенье");
	
	// Задаем параметры шрифта и областей
	ШапкаДней = Объект.Данные.ПолучитьОбласть(1, 1, 1, КоличествоДней);
	ШапкаЧасов = Объект.Данные.ПолучитьОбласть(2, 1, КонечныйЧас + 3, 1);
	ОбластьЯчейки = Объект.Данные.ПолучитьОбласть(2, 2, КонечныйЧас + 3, КоличествоДней);
	
	// --- Формирование шапки с днями недели ---
	Для Индекс = 1 По КоличествоДней Цикл
		ОбластьШапки = Объект.Данные.Область(1, Индекс);
		ОбластьШапки.Текст = МассивДнейНедели[Индекс - 1];
		ОбластьШапки.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Центр;
		ОбластьШапки.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
		ОбластьШапки.ЦветФона = WebЦвета.СветлоСерый; // Выделим фон
		ОбластьШапки.ГраницаСверху=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		ОбластьШапки.ГраницаСнизу=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		ОбластьШапки.ГраницаСлева=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		ОбластьШапки.ГраницаСправа=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		ОбластьШапки.ШиринаКолонки=15;
	КонецЦикла;
	
	// --- Формирование колонки с часами ---
	Для Час = НачальныйЧас По КонечныйЧас Цикл
		ТекущийНомерСтроки = (Час-8) + 1; // +2 т.к. отсчет от 1, +1 для пропуска шапки
		
		ОбластьЧаса = Объект.Данные.Область(ТекущийНомерСтроки, 1);
		ОбластьЧаса.Текст = Формат(Час, "ЧЦ=2; ЧВН=") + ":00";
		ОбластьЧаса.ГоризонтальноеПоложение = ГоризонтальноеПоложение.Центр;
		ОбластьЧаса.ВертикальноеПоложение = ВертикальноеПоложение.Центр;
		ОбластьЧаса.ЦветФона = WebЦвета.СветлоСерый; // Выделим фон
		ОбластьЧаса.ГраницаСверху=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		ОбластьЧаса.ГраницаСнизу=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		ОбластьЧаса.ГраницаСлева=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		ОбластьЧаса.ГраницаСправа=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
	КонецЦикла;
	
	// --- Формирование ячеек для записей и границ ---
	Для Час = НачальныйЧас По КонечныйЧас Цикл
		ТекущийНомерСтроки = (Час-8)  + 1;
		
		Для День = 1 По КоличествоДней Цикл
			ТекущийНомерКолонки = День ;
			
			// Устанавливаем границы для ячеек, чтобы таблица была видна
			Область = Объект.Данные.Область(ТекущийНомерСтроки, ТекущийНомерКолонки);
				
			// Можно задать фиксированную высоту строки
			Область.ВысотаСтроки = 10;
		Область.ГраницаСверху=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		Область.ГраницаСнизу=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		Область.ГраницаСлева=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		Область.ГраницаСправа=Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
		КонецЦикла;
	КонецЦикла;
	


	
КонецПроцедуры

