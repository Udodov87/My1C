
&НаКлиенте
Процедура НайдиВDeepSeek(Команда)
объект.Ответ=ПолучитьДанныеКонтрагентаПоИНН(объект.ИНН)
КонецПроцедуры


&НаСервере
Функция ПолучитьДанныеКонтрагентаПоИНН(ИНН)
	
	// Настройки подключения
	Токен = "2a124ce513b1606c0d1decb8968a264ccd3e9333"; // Замените на свой ключ из DaData
	АдресСервиса = "suggestions.dadata.ru";
	Ресурс = "/suggestions/api/4_1/rs/findById/party";
	
	// Подготовка тела запроса (JSON)
	ПараметрыЗапроса = Новый Структура;
	ПараметрыЗапроса.Вставить("query", ИНН);
	
	ЗаписьJSON = Новый ЗаписьJSON;
	ЗаписьJSON.УстановитьСтроку();
	ЗаписатьJSON(ЗаписьJSON, ПараметрыЗапроса);
	СтрокаЗапросаJSON = ЗаписьJSON.Закрыть();
	
	// Создание HTTP-запроса
	НТТРСоединение = Новый HTTPСоединение(АдресСервиса, 443, , , , , Новый ЗащищенноеСоединениеOpenSSL());
	
	Заголовки = Новый Соответствие;
	Заголовки.Вставить("Content-Type", "application/json");
	Заголовки.Вставить("Accept",       "application/json");
	Заголовки.Вставить("Authorization", "Token " + Токен);
	
	HTTPЗапрос = Новый HTTPЗапрос(Ресурс, Заголовки);
	HTTPЗапрос.УстановитьТелоИзСтроки(СтрокаЗапросаJSON, КодировкаТекста.UTF8);
	
	Попытка
		Ответ = НТТРСоединение.ОтправитьДляОбработки(HTTPЗапрос);
		СодержимоеОтвета = Ответ.ПолучитьТелоКакСтроку(КодировкаТекста.UTF8);
		
		Если Ответ.КодСостояния = 200 Тогда
			// Чтение результата
			ЧтениеJSON = Новый ЧтениеJSON;
			ЧтениеJSON.УстановитьСтроку(СодержимоеОтвета);
			Результат = ПрочитатьJSON(ЧтениеJSON);
			ЧтениеJSON.Закрыть();
			
			
			Возврат СодержимоеОтвета;
		Иначе
		
			Возврат Неопределено;
		КонецЕсли;
	Исключение
		
		Возврат Неопределено;
	КонецПопытки;
	
КонецФункции


